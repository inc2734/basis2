@mixin _aside() {
  flex-basis: var(--sidebar-width);
  flex-grow: 1;
}

@mixin _main() {
  flex-basis: 0;
  flex-grow: 999;
  min-width: var(--content-min-width);
}

@mixin with-sidebar() {
  [data-layout~="with-sidebar"] {
    --content-min-width: 50%;
    --gap: var(--s1);

    display: flex;
    flex-wrap: wrap;
    gap: var(--gap);
  }

  [data-layout~="with-sidebar"]:not([data-layout~="-revert"])[data-layout~="-sidebar\:right"],
  [data-layout~="with-sidebar"]:not([data-layout~="-revert"]):not([data-layout~="-sidebar\:left"]),
  [data-layout~="with-sidebar"][data-layout~="-revert"][data-layout~="-sidebar\:left"] {
    > :first-child {
      @include _main();
    }

    > :last-child {
      @include _aside();
    }
  }

  [data-layout~="with-sidebar"]:not([data-layout~="-revert"])[data-layout~="-sidebar\:left"],
  [data-layout~="with-sidebar"][data-layout~="-revert"][data-layout~="-sidebar\:right"],
  [data-layout~="with-sidebar"][data-layout~="-revert"]:not([data-layout~="-sidebar\:left"]) {
    > :first-child {
      @include _aside();
    }

    > :last-child {
      @include _main();
    }
  }

  [data-layout~="with-sidebar"][data-layout~="-revert"] {
    flex-direction: row-reverse;
  }
}
